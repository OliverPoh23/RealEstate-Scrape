Function Get-ApartmentListings_Trulia
{
    [cmdletbinding()]
    Param(
        [string]$State_Code,
        [string]$City
    )
    if(!("Execute.HttpRequest" -as [type]))
    {
        Add-Type -Path ..\lib\Execute.HttpRequest.dll
    }
    $Uri = "https://www.trulia.com/graphql?opname=WEB_searchHomesBySearchDetailsQuery&transactionId=client-c16a4119-0806-4e2e-8d5e-d64da5402cce"
    $Headers = [ordered]@{
        "method"="POST"
        "authority"="www.trulia.com"
        "scheme"="https"
        "path"="/graphql?opname=WEB_searchHomesBySearchDetailsQuery&transactionId=client-c16a4119-0806-4e2e-8d5e-d64da5402cce"
        "pragma"="no-cache"
        "cache-control"="no-cache"
        "sec-ch-ua"="`"Google Chrome`";v=`"89`", `"Chromium`";v=`"89`", `";Not A Brand`";v=`"99`""
        "x-zg-search"="1"
        "x-csrf-token"="VymiPdIE-egWIz4YFHu_nf_mTYWSjNWEXyfY"
        "sec-ch-ua-mobile"="?0"
        "user-agent"="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36"
        "accept"="*/*"
        "x-srp-tabs-disabled"="0"
        "dnt"="1"
        "x-request-id"="client-c16a4119-0806-4e2e-8d5e-d64da5402cce"
        "origin"="https://www.trulia.com"
        "sec-fetch-site"="same-origin"
        "sec-fetch-mode"="cors"
        "sec-fetch-dest"="empty"
        "referer"="https://www.trulia.com/for_rent/$($City),$($State_Code)/1p_beds/1p_baths/aircondition,microwave,washerdryer_uamenities/"
        "accept-encoding"="gzip, deflate"
        "accept-language"="en-US,en;q=0.9"
    }
    $ContentType = "application/json"
    $Body = "{`"operationName`":`"WEB_searchHomesBySearchDetailsQuery`",`"variables`":{`"defaultSortType`":null,`"defaultSortDirection`":null,`"isMoreStatsTrendsEnabled`":true,`"includeNearBy`":true,`"heroImageFallbacks`":[`"STREET_VIEW`",`"SATELLITE_VIEW`"],`"searchDetails`":{`"searchType`":`"FOR_RENT`",`"location`":{`"cities`":[{`"city`":`"$($City)`",`"state`":`"$($State_Code)`"}]},`"filters`":{`"bathrooms`":{`"min`":`"1`",`"max`":`"*`"},`"bedrooms`":{`"min`":`"1`",`"max`":`"*`"},`"pets`":[],`"propertyTypes`":[],`"sort`":{`"type`":`"RENTAL_PRIORITY_SCORE`",`"ascending`":false},`"page`":1,`"limit`":30,`"listingTypes`":[],`"rentalListingTags`":[],`"foreclosureTypes`":[],`"buildingAmenities`":[],`"unitAmenities`":[`"WASHERDRYER`",`"AIRCONDITION`",`"MICROWAVE`",`"DISHWASHER`"],`"landlordPays`":[]}},`"isBot`":false,`"isSPA`":false},`"query`":`"query WEB_searchHomesBySearchDetailsQuery(`$searchDetails: SEARCHDETAILS_Input!, `$heroImageFallbacks: [MEDIA_HeroImageFallbackTypes!], `$isBot: Boolean!, `$isSPA: Boolean!, `$defaultSortType: SEARCHDETAILS_SortType = null, `$defaultSortDirection: SEARCHDETAILS_SortDirection = null, `$isMoreStatsTrendsEnabled: Boolean = true, `$includeNearBy: Boolean = true) {\n  searchHomesByDetails(searchDetails: `$searchDetails, defaultSortType: `$defaultSortType, defaultSortDirection: `$defaultSortDirection, includeNearBy: `$includeNearBy) {\n    ...SearchResultsContentFragment\n    __typename\n  }\n}\n\nfragment SearchResultsContentFragment on SEARCH_Result {\n  currentUrl\n  canonicalUrl\n  adTargetings @skip(if: `$isBot)\n  ...SearchResultHeaderLocationFragment\n  ...SearchResultsMarketDetailsFragment @include(if: `$isBot)\n  ...SearchResultsHomesListFragment\n  ...SearchResultsPaginationFragment\n  ...SearchResultsBreadcrumbsFragment\n  ...SearchResultsMapFragment\n  ...SearchResultsFooterCardFragment\n  ...SearchResultsFiltersFragment\n  ...SearchResultsProviderAttributionFragment\n  details {\n    ...SearchDetailsFragment\n    canonicalUrl\n    __typename\n  }\n  names {\n    title\n    locationName\n    description\n    __typename\n  }\n  tracking {\n    key\n    value\n    __typename\n  }\n  pageDisplayFlags {\n    isAdvertisingRestricted\n    __typename\n  }\n  nearByHomes {\n    ...HomeDetailsCardFragment\n    ...HomeDetailsCardPhotosFragment\n    ...SingleFamilyResidenceJsonLdFragment\n    ...OpenHouseJsonLdFragment\n    ...HomeDetailsCallToActionFragment\n    ...HomeDetailsTopThirdFragment @include(if: `$isSPA)\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultHeaderLocationFragment on SEARCH_Result {\n  location {\n    ... on SEARCH_ResultLocationBoundingBox {\n      city\n      state\n      __typename\n    }\n    ... on SEARCH_ResultLocationCity {\n      city\n      state\n      __typename\n    }\n    ... on SEARCH_ResultLocationCounty {\n      county\n      state\n      __typename\n    }\n    ... on SEARCH_ResultLocationNeighborhood {\n      city\n      state\n      neighborhood\n      __typename\n    }\n    ... on SEARCH_ResultLocationPostalCode {\n      city\n      state\n      postalCode\n      __typename\n    }\n    ... on SEARCH_ResultLocationSchool {\n      name\n      __typename\n    }\n    ... on SEARCH_ResultLocationSchoolDistrict {\n      city\n      state\n      schoolDistrictIds\n      __typename\n    }\n    __typename\n  }\n  recentSearches {\n    title\n    type\n    url\n    locationDetails {\n      cities {\n        city\n        state\n        __typename\n      }\n      counties\n      neighborhoods\n      zips\n      schoolDistricts\n      school {\n        id\n        name\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  pageDisplayFlags {\n    shouldDisplayZINCAttribution\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsHomesListFragment on SEARCH_Result {\n  homeCounts {\n    agentListingsCount {\n      value\n      __typename\n    }\n    otherListingsCount {\n      value\n      __typename\n    }\n    __typename\n  }\n  homes {\n    ...HomeDetailsCardFragment\n    ...HomeDetailsCardPhotosFragment\n    ...SingleFamilyResidenceJsonLdFragment\n    ...OpenHouseJsonLdFragment\n    ...HomeDetailsCallToActionFragment\n    ...HomeDetailsTopThirdFragment @include(if: `$isSPA)\n    __typename\n  }\n  ...FailedSearchFragment\n  names {\n    headerTag\n    subHeaderTag\n    resultsIncludeDescription\n    searchResultsMapTag\n    nearByHeaderTag\n    nearBySubHeaderTag\n    __typename\n  }\n  totalHomes\n  details {\n    ...SearchResultsSortFragment\n    __typename\n  }\n  emptyState {\n    noHomesFoundText\n    noHomesFoundCTAText\n    reason\n    __typename\n  }\n  moreHomesInformation {\n    title\n    body\n    ctaTitle\n    __typename\n  }\n  __typename\n}\n\nfragment HomeDetailsCardFragment on HOME_Details {\n  __typename\n  location {\n    city\n    stateCode\n    neighborhoodName\n    fullLocation: formattedLocation(formatType: STREET_CITY_STATE_ZIP)\n    partialLocation: formattedLocation(formatType: STREET_ONLY)\n    __typename\n  }\n  price {\n    formattedPrice\n    __typename\n  }\n  url\n  tags(include: MINIMAL) {\n    level\n    formattedName\n    icon {\n      vectorImage {\n        svg\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  fullTags: tags {\n    level\n    formattedName\n    icon {\n      vectorImage {\n        svg\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  floorSpace {\n    formattedDimension\n    __typename\n  }\n  bedrooms {\n    formattedValue(formatType: TWO_LETTER_ABBREVIATION)\n    __typename\n  }\n  bathrooms {\n    formattedValue(formatType: TWO_LETTER_ABBREVIATION)\n    __typename\n  }\n  isSaveable\n  preferences {\n    isSaved\n    __typename\n  }\n  metadata {\n    compositeId\n    legacyIdForSave\n    __typename\n  }\n  tracking {\n    key\n    value\n    __typename\n  }\n  displayFlags {\n    showMLSLogoOnListingCard\n    addAttributionProminenceOnListCard\n    __typename\n  }\n  ... on HOME_RoomForRent {\n    numberOfRoommates\n    availableDate: formattedAvailableDate(dateFormat: \`"MMM D\`")\n    __typename\n  }\n  ... on HOME_RentalCommunity {\n    activeListing {\n      provider {\n        summary(formatType: SHORT)\n        listingSource {\n          logoUrl\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  ... on HOME_Property {\n    currentStatus {\n      isRecentlySold\n      isRecentlyRented\n      isActiveForRent\n      isActiveForSale\n      isOffMarket\n      isForeclosure\n      __typename\n    }\n    priceChange {\n      priceChangeDirection\n      __typename\n    }\n    activeListing {\n      provider {\n        summary(formatType: SHORT)\n        extraShortSummary: summary(formatType: EXTRA_SHORT)\n        listingSource {\n          logoUrl\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    lastSold {\n      provider {\n        summary(formatType: SHORT)\n        extraShortSummary: summary(formatType: EXTRA_SHORT)\n        listingSource {\n          logoUrl\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  ... on HOME_FloorPlan {\n    priceChange {\n      priceChangeDirection\n      __typename\n    }\n    provider {\n      summary(formatType: SHORT)\n      __typename\n    }\n    __typename\n  }\n  ... on HOME_RentalCommunity {\n    location {\n      communityLocation: formattedLocation(formatType: STREET_COMMUNITY_NAME)\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment HomeDetailsCardPhotosFragment on HOME_Details {\n  media {\n    __typename\n    heroImage(fallbacks: `$heroImageFallbacks) {\n      url {\n        small\n        __typename\n      }\n      webpUrl: url(compression: webp) {\n        small\n        __typename\n      }\n      __typename\n    }\n    photos {\n      url {\n        small\n        __typename\n      }\n      webpUrl: url(compression: webp) {\n        small\n        __typename\n      }\n      __typename\n    }\n  }\n  __typename\n}\n\nfragment HomeDetailsCallToActionFragment on HOME_Details {\n  hasPrequalifiers\n  leadFormCallToAction(context: CARD, appendOneClick: true) {\n    callToActionType\n    callToActionDisplayLabel\n    supportsCancellableSubmission\n    buttonStyle\n    __typename\n  }\n  __typename\n}\n\nfragment FailedSearchFragment on SEARCH_Result {\n  names {\n    locationName\n    __typename\n  }\n  location {\n    __typename\n    ... on SEARCH_ResultLocationPointOfInterest {\n      exactCoordinates {\n        latitude\n        longitude\n        __typename\n      }\n      __typename\n    }\n  }\n  __typename\n}\n\nfragment SearchResultsSortFragment on SEARCHDETAILS_Details {\n  filters {\n    sort {\n      type\n      ascending\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SingleFamilyResidenceJsonLdFragment on HOME_Property {\n  location {\n    partialLocation: formattedLocation(formatType: STREET_ONLY)\n    city\n    stateCode\n    zipCode\n    coordinates {\n      latitude\n      longitude\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment OpenHouseDateFragment on HOME_Listing {\n  openHouses {\n    ... on HOME_ScheduledOpenHouse {\n      start\n      end\n      startHour: formattedStartTime(format: \`"hA\`")\n      endHour: formattedEndTime(format: \`"hA\`")\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment OpenHouseJsonLdFragment on HOME_Details {\n  ... on HOME_Property {\n    url\n    location {\n      formattedLocation\n      partialLocation: formattedLocation(formatType: STREET_ONLY)\n      city\n      stateCode\n      zipCode\n      coordinates {\n        latitude\n        longitude\n        __typename\n      }\n      __typename\n    }\n    activeForSaleListing {\n      ...OpenHouseDateFragment\n      __typename\n    }\n    activeForRentListing {\n      ...OpenHouseDateFragment\n      __typename\n    }\n    media {\n      hasThreeDHome\n      hasVideo\n      __typename\n    }\n    ...VirtualTourJsonLdSchemaFragment\n    __typename\n  }\n  ... on HOME_RoomForRent {\n    activeForRentListing {\n      ...OpenHouseDateFragment\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment VirtualTourJsonLdSchemaFragment on HOME_Details {\n  price {\n    ... on HOME_SinglePrice {\n      price\n      __typename\n    }\n    ... on HOME_ValuationPrice {\n      price\n      __typename\n    }\n    ... on HOME_ListingSinglePrice {\n      price\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment HomeDetailsTopThirdFragment on HOME_Details {\n  bathrooms {\n    summaryBathrooms: formattedValue(formatType: COMMON_ABBREVIATION)\n    __typename\n  }\n  bedrooms {\n    summaryBedrooms: formattedValue(formatType: COMMON_ABBREVIATION)\n    __typename\n  }\n  floorSpace {\n    formattedDimension\n    __typename\n  }\n  location {\n    city\n    coordinates {\n      latitude\n      longitude\n      __typename\n    }\n    neighborhoodName\n    stateCode\n    zipCode\n    cityStateZipAddress: formattedLocation(formatType: CITY_STATE_ZIP)\n    homeFormattedAddress: formattedLocation\n    summaryFormattedLocation: formattedLocation(formatType: STREET_COMMUNITY_BUILDER)\n    __typename\n  }\n  media {\n    metaTagHeroImages: heroImage(fallbacks: `$heroImageFallbacks) {\n      url {\n        desktop: custom(size: {width: 2048, height: 200})\n        __typename\n      }\n      __typename\n    }\n    topThirdHeroImages: heroImage(fallbacks: `$heroImageFallbacks) {\n      __typename\n      url {\n        extraSmallSrc: custom(size: {width: 375, height: 275})\n        smallSrc: custom(size: {width: 570, height: 275})\n        mediumSrc: custom(size: {width: 768, height: 500})\n        largeSrc: custom(size: {width: 992, height: 500})\n        hiDipExtraSmallSrc: custom(size: {width: 1125, height: 825})\n        hiDpiSmallSrc: custom(size: {width: 1710, height: 825})\n        hiDpiMediumSrc: custom(size: {width: 2048, height: 1536})\n        __typename\n      }\n      webpUrl: url(compression: webp) {\n        extraSmallWebpSrc: custom(size: {width: 375, height: 275})\n        smallWebpSrc: custom(size: {width: 570, height: 275})\n        mediumWebpSrc: custom(size: {width: 768, height: 500})\n        largeWebpSrc: custom(size: {width: 992, height: 500})\n        hiDipExtraSmallWebpSrc: custom(size: {width: 1125, height: 825})\n        hiDpiSmallWebpSrc: custom(size: {width: 1710, height: 825})\n        hiDpiMediumWebpSrc: custom(size: {width: 2048, height: 1536})\n        __typename\n      }\n    }\n    totalPhotoCount\n    __typename\n  }\n  metadata {\n    compositeId\n    currentListingId\n    __typename\n  }\n  pageText {\n    title\n    metaDescription\n    __typename\n  }\n  price {\n    formattedPrice\n    ... on HOME_LastSoldPrice {\n      formattedPriceDifferencePercent\n      formattedSoldDate(dateFormat: \`"MMM D, YYYY\`")\n      listingPrice {\n        formattedPrice(formatType: SHORT_ABBREVIATION)\n        __typename\n      }\n      priceDifferencePercent\n      pricePerDimension {\n        formattedDimension\n        __typename\n      }\n      __typename\n    }\n    ... on HOME_ForeclosureEstimatePrice {\n      price\n      typeDescription\n      __typename\n    }\n    ... on HOME_PriceRange {\n      currencyCode\n      max\n      min\n      __typename\n    }\n    ... on HOME_SinglePrice {\n      currencyCode\n      price\n      __typename\n    }\n    __typename\n  }\n  tracking {\n    key\n    value\n    __typename\n  }\n  url\n  ... on HOME_Property {\n    currentStatus {\n      isOffMarket\n      isRecentlySold\n      isForeclosure\n      isActiveForRent\n      isActiveForSale\n      isRecentlyRented\n      label\n      __typename\n    }\n    __typename\n  }\n  ... on HOME_RentalCommunity {\n    location {\n      rentalCommunityFormattedLocation: formattedLocation(formatType: STREET_COMMUNITY_NAME)\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsPaginationFragment on SEARCH_Result {\n  totalHomes\n  currentUrl\n  details {\n    filters {\n      page\n      limit\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsBreadcrumbsFragment on SEARCH_Result {\n  navigation {\n    label\n    url\n    linkType\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsMapFragment on SEARCH_Result {\n  mapEmptyState: emptyState(format: SHORT) {\n    noHomesFoundText\n    __typename\n  }\n  details {\n    filters {\n      zoom\n      __typename\n    }\n    __typename\n  }\n  names {\n    searchResultsMapTag\n    __typename\n  }\n  location {\n    boundingBox {\n      minCoordinates {\n        latitude\n        longitude\n        __typename\n      }\n      maxCoordinates {\n        latitude\n        longitude\n        __typename\n      }\n      __typename\n    }\n    ... on SEARCH_ResultLocationCity {\n      locationId\n      __typename\n    }\n    ... on SEARCH_ResultLocationCounty {\n      locationId\n      __typename\n    }\n    ... on SEARCH_ResultLocationNeighborhood {\n      locationId\n      __typename\n    }\n    ... on SEARCH_ResultLocationPostalCode {\n      locationId\n      __typename\n    }\n    __typename\n  }\n  ...HomeMarkerLayersContainerFragment\n  ...HoverCardLayerFragment\n  __typename\n}\n\nfragment HomeMarkerLayersContainerFragment on SEARCH_Result {\n  ...HomeMarkersLayerFragment\n  __typename\n}\n\nfragment HomeMarkersLayerFragment on SEARCH_Result {\n  homes {\n    location {\n      coordinates {\n        latitude\n        longitude\n        __typename\n      }\n      __typename\n    }\n    url\n    metadata {\n      compositeId\n      __typename\n    }\n    ...HomeMarkerFragment\n    __typename\n  }\n  nearByHomes {\n    ...HomeMarkerFragment\n    __typename\n  }\n  __typename\n}\n\nfragment HomeMarkerFragment on HOME_Details {\n  media {\n    hasThreeDHome\n    __typename\n  }\n  location {\n    coordinates {\n      latitude\n      longitude\n      __typename\n    }\n    __typename\n  }\n  displayFlags {\n    enableMapPin\n    __typename\n  }\n  price {\n    calloutMarkerPrice: formattedPrice(formatType: SHORT_ABBREVIATION)\n    __typename\n  }\n  url\n  ... on HOME_Property {\n    activeForSaleListing {\n      openHouses {\n        formattedDay\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  ...HomeDetailsTopThirdFragment @include(if: `$isSPA)\n  __typename\n}\n\nfragment HoverCardLayerFragment on SEARCH_Result {\n  homes {\n    ...HomeHoverCardFragment\n    __typename\n  }\n  nearByHomes {\n    ...HomeHoverCardFragment\n    __typename\n  }\n  __typename\n}\n\nfragment HomeHoverCardFragment on HOME_Details {\n  ...HomeDetailsCardFragment\n  ...HomeDetailsCardHeroFragment\n  location {\n    coordinates {\n      latitude\n      longitude\n      __typename\n    }\n    __typename\n  }\n  displayFlags {\n    enableMapPin\n    showMLSLogoOnMapMarkerCard\n    __typename\n  }\n  __typename\n}\n\nfragment HomeDetailsCardHeroFragment on HOME_Details {\n  media {\n    heroImage(fallbacks: `$heroImageFallbacks) {\n      url {\n        small\n        __typename\n      }\n      webpUrl: url(compression: webp) {\n        small\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsFiltersFragment on SEARCH_Result {\n  transitSystems {\n    name\n    iconUrl(format: SVG)\n    isSelected\n    filterLabel\n    __typename\n  }\n  homeCounts {\n    agentListingsCount {\n      formattedValue\n      __typename\n    }\n    otherListingsCount {\n      formattedValue\n      __typename\n    }\n    __typename\n  }\n  details {\n    searchType\n    ...SearchResultsSortFragment\n    filters {\n      isAlternateListingSource\n      price {\n        min\n        max\n        __typename\n      }\n      bedrooms {\n        min\n        max\n        __typename\n      }\n      bathrooms {\n        min\n        max\n        __typename\n      }\n      squareFeet {\n        min\n        max\n        __typename\n      }\n      hoaFee {\n        min\n        max\n        __typename\n      }\n      propertyTypes\n      lotSize {\n        min\n        max\n        __typename\n      }\n      mlsId\n      newListing {\n        range {\n          min\n          max\n          timestamp\n          __typename\n        }\n        daysAgo\n        __typename\n      }\n      recentlyReduced {\n        range {\n          min\n          max\n          timestamp\n          __typename\n        }\n        daysAgo\n        __typename\n      }\n      openHomes {\n        range {\n          min\n          max\n          timestamp\n          __typename\n        }\n        type\n        __typename\n      }\n      yearBuilt {\n        min\n        max\n        __typename\n      }\n      keywords\n      listingTypes\n      soldWithin\n      pets\n      furnished\n      rentalListingTags\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsProviderAttributionFragment on SEARCH_Result {\n  providers {\n    listingSource {\n      logoUrl\n      attribution\n      alternativeSources {\n        name\n        url\n        __typename\n      }\n      disclaimer {\n        markdown\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsMarketDetailsFragment on SEARCH_Result {\n  ...SearchResultsNeighborhoodsListFragment\n  ...MarketInsightsDataFragment\n  ...SearchResultsSummaryFragment\n  ...SearchResultsWhatLocalsSayFragment\n  __typename\n}\n\nfragment SearchResultsNeighborhoodsListFragment on SEARCH_Result {\n  surroundings {\n    ...NeighborhoodCardFragment\n    __typename\n  }\n  __typename\n}\n\nfragment NeighborhoodCardFragment on SURROUNDINGS_Neighborhood {\n  name\n  ndpActive\n  ndpUrl\n  media {\n    heroImage {\n      ... on MEDIA_HeroImageMap {\n        url {\n          path: custom(size: {width: 136, height: 136, cropMode: fill}, zoomLevel: 1100)\n          __typename\n        }\n        __typename\n      }\n      ... on MEDIA_HeroImageStory {\n        url {\n          path: custom(size: {width: 136, height: 136, cropMode: fill})\n          __typename\n        }\n        __typename\n      }\n      ... on MEDIA_HeroImagePhoto {\n        url {\n          path: custom(size: {width: 136, height: 136, cropMode: fill})\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  localFacts {\n    forSaleStats {\n      min\n      max\n      __typename\n    }\n    homesForSaleCount\n    forRentStats {\n      min\n      max\n      __typename\n    }\n    homesForRentCount\n    soldHomesStats {\n      min\n      max\n      __typename\n    }\n    soldHomesCount\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsWhatLocalsSayFragment on SEARCH_Result {\n  searchLocationSurroundings {\n    locationId\n    name\n    ... on SURROUNDINGS_Neighborhood {\n      ndpType\n      ndpUrl\n      name\n      ndpActive\n      localUGC {\n        ... on SURROUNDINGS_LocalUGC {\n          ...LocalUGCFragment\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    ... on SURROUNDINGS_City {\n      localUGC {\n        ... on SURROUNDINGS_LocalUGC {\n          ...LocalUGCFragment\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment LocalUGCFragment on SURROUNDINGS_LocalUGC {\n  title\n  stats {\n    attributes {\n      type\n      name\n      score\n      __typename\n    }\n    minimumResponseCount\n    __typename\n  }\n  localReviews {\n    categories {\n      id\n      displayName\n      reviewCount\n      callToAction\n      __typename\n    }\n    totalReviews\n    reviews(limitPerCategory: 8) {\n      id\n      text\n      context {\n        displayName\n        __typename\n      }\n      category {\n        id\n        displayName\n        __typename\n      }\n      dateCreated\n      reactionSummary {\n        counts {\n          helpful\n          __typename\n        }\n        viewerReactions {\n          helpful\n          __typename\n        }\n        __typename\n      }\n      flagSummary {\n        totalCount\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsSummaryFragment on SEARCH_Result {\n  marketInsights(sourceAllFromZHVI: `$isMoreStatsTrendsEnabled) {\n    rentalMarketInsights {\n      medianRentalPriceAverageForPastYear\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment MarketInsightsDataFragment on SEARCH_Result {\n  names {\n    locationName\n    __typename\n  }\n  ...PartialMarketInsightsDataFragment\n  surroundings {\n    ...NeighborhoodDataFragment\n    __typename\n  }\n  __typename\n}\n\nfragment PartialMarketInsightsDataFragment on SEARCH_Result {\n  marketInsights(sourceAllFromZHVI: `$isMoreStatsTrendsEnabled) {\n    homeStatsByBedroomCount: statsByHomeFeature(featureType: BEDROOMS) @include(if: `$isMoreStatsTrendsEnabled) {\n      displayName\n      featureStats {\n        displayName\n        homeValueIndexPrice\n        inventorySummary\n        ... on STATS_AND_TRENDS_HomeFeatureStat {\n          forSaleSearchUrl\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    affordability {\n      name\n      summary\n      trend {\n        value\n        formattedValue\n        date\n        formattedDate(dateFormat: \`"MMMM YYYY\`")\n        __typename\n      }\n      __typename\n    }\n    affordabilityAttribution\n    __typename\n  }\n  __typename\n}\n\nfragment NeighborhoodDataFragment on SURROUNDINGS_Neighborhood {\n  name\n  forSaleNeighborhoodSearchCanonicalURL\n  localFacts {\n    homesForSaleCount\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsFooterCardFragment on SEARCH_Result {\n  homes {\n    ...HomeDetailsCardFragment\n    ...HomeDetailsCardPhotosFragment\n    ...HomeDetailsTopThirdFragment @include(if: `$isSPA)\n    __typename\n  }\n  __typename\n}\n\nfragment SearchDetailsFragment on SEARCHDETAILS_Details {\n  searchType\n  location {\n    cities {\n      city\n      state\n      __typename\n    }\n    counties\n    neighborhoods\n    zips\n    schoolDistricts\n    university {\n      id\n      name\n      __typename\n    }\n    school {\n      id\n      name\n      __typename\n    }\n    customArea {\n      latLngs {\n        latitude\n        longitude\n        __typename\n      }\n      encodedPolygon\n      __typename\n    }\n    commute {\n      type\n      maxTime\n      polygons {\n        latitude\n        longitude\n        __typename\n      }\n      __typename\n    }\n    pointOfInterest {\n      latitude\n      longitude\n      __typename\n    }\n    coordinates {\n      center {\n        latitude\n        longitude\n        __typename\n      }\n      southEast {\n        latitude\n        longitude\n        __typename\n      }\n      northEast {\n        latitude\n        longitude\n        __typename\n      }\n      southWest {\n        latitude\n        longitude\n        __typename\n      }\n      northWest {\n        latitude\n        longitude\n        __typename\n      }\n      __typename\n    }\n    radiusSize\n    __typename\n  }\n  filters {\n    bedrooms {\n      min\n      max\n      __typename\n    }\n    bathrooms {\n      min\n      max\n      __typename\n    }\n    price {\n      min\n      max\n      __typename\n    }\n    squareFeet {\n      min\n      max\n      __typename\n    }\n    hoaFee {\n      min\n      max\n      __typename\n    }\n    zoom\n    street\n    propertyTypes\n    lotSize {\n      min\n      max\n      __typename\n    }\n    mlsId\n    newListing {\n      range {\n        min\n        max\n        timestamp\n        __typename\n      }\n      daysAgo\n      __typename\n    }\n    openHomes {\n      range {\n        min\n        max\n        timestamp\n        __typename\n      }\n      __typename\n    }\n    percentChanged\n    recentlyReduced {\n      range {\n        min\n        max\n        timestamp\n        __typename\n      }\n      daysAgo\n      __typename\n    }\n    pricePerSquareFoot {\n      min\n      max\n      __typename\n    }\n    yearBuilt {\n      min\n      max\n      __typename\n    }\n    keywords\n    listingTypes\n    foreclosureTypes\n    discoveryGroup\n    sort {\n      type\n      ascending\n      __typename\n    }\n    soldWithin\n    pets\n    brokerFee\n    buildingAmenities\n    unitAmenities\n    furnished\n    rentalListingTags\n    landlordPays\n    page\n    offset\n    limit\n    transit {\n      system\n      line\n      station\n      __typename\n    }\n    __typename\n  }\n  canonicalUrl\n  description\n  __typename\n}\n`"}"
    $r = [Execute.httpRequest]::Send(
        $Uri,
        [System.Net.Http.HttpMethod]::Post,
        $Headers,
        $null,
        $ContentType,
        $Body
    )
    $results = @()
    $json = $r.ResponseText | ConvertFrom-Json
    $total_results = $JSON.data.searchHomesByDetails.totalHomes
    $per_page = $JSON.data.searchHomesByDetails.homes.Count
    $no_pages = [Math]::Ceiling(($total_results / $per_page))
    $JSON.data.searchHomesByDetails.homes.ForEach({ $results += $_ })
    
    $Uri = "https://www.trulia.com/graphql?opname=WEB_searchHomes&transactionId=client-c16a4119-0806-4e2e-8d5e-d64da5402cce"
    $Headers = [ordered]@{
        "method"="POST"
        "authority"="www.trulia.com"
        "scheme"="https"
        "path"="/graphql?opname=WEB_searchHomes&transactionId=client-c16a4119-0806-4e2e-8d5e-d64da5402cce"
        "pragma"="no-cache"
        "cache-control"="no-cache"
        "sec-ch-ua"="`"Google Chrome`";v=`"89`", `"Chromium`";v=`"89`", `";Not A Brand`";v=`"99`""
        "x-zg-search"="1"
        "x-csrf-token"="VymiPdIE-egWIz4YFHu_nf_mTYWSjNWEXyfY"
        "sec-ch-ua-mobile"="?0"
        "user-agent"="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36"
        "accept"="*/*"
        "x-srp-tabs-disabled"="0"
        "dnt"="1"
        "x-request-id"="client-c16a4119-0806-4e2e-8d5e-d64da5402cce"
        "origin"="https://www.trulia.com"
        "sec-fetch-site"="same-origin"
        "sec-fetch-mode"="cors"
        "sec-fetch-dest"="empty"
        "referer"="https://www.trulia.com/for_rent/$($City),$($State_Code)/1p_beds/1p_baths/aircondition,dishwasher,microwave,washerdryer_uamenities/"
        "accept-encoding"="gzip, deflate"
        "accept-language"="en-US,en;q=0.9"
    }
    for($i = 2; $i -lt $no_pages; $i++)
    {
        $Body = "{`"operationName`":`"WEB_searchHomes`",`"variables`":{`"shouldIncludeSrpFragment`":true,`"shouldIncludeHeaderAndFooterFragment`":true,`"defaultSortType`":null,`"defaultSortDirection`":null,`"isMoreStatsTrendsEnabled`":false,`"includeNearBy`":true,`"heroImageFallbacks`":[`"STREET_VIEW`",`"SATELLITE_VIEW`"],`"url`":`"/for_rent/$($City),$($State_Code)/1p_beds/1p_baths/aircondition,dishwasher,microwave,washerdryer_uamenities/$($i)_p/`",`"query`":null,`"searchEncodedHash`":null,`"searchTypeForQuery`":null,`"isBot`":false,`"isSPA`":false},`"query`":`"query WEB_searchHomes(`$url: String!, `$heroImageFallbacks: [MEDIA_HeroImageFallbackTypes!], `$isBot: Boolean!, `$isSPA: Boolean!, `$shouldIncludeSrpFragment: Boolean = true, `$shouldIncludeHeaderAndFooterFragment: Boolean = true, `$defaultSortType: SEARCHDETAILS_SortType = null, `$defaultSortDirection: SEARCHDETAILS_SortDirection = null, `$isMoreStatsTrendsEnabled: Boolean = true, `$includeNearBy: Boolean = false) {\n  searchHomesByUrl(url: `$url, defaultSortType: `$defaultSortType, defaultSortDirection: `$defaultSortDirection, includeNearBy: `$includeNearBy) {\n    ...SearchResultsContentFragment @include(if: `$shouldIncludeSrpFragment)\n    ...HeaderAndFooterFragment @include(if: `$shouldIncludeHeaderAndFooterFragment)\n    ...SearchResultsBranchBannerFragmnet @include(if: `$shouldIncludeSrpFragment)\n    __typename\n  }\n  viewer {\n    ...Viewer\n    __typename\n  }\n}\n\nfragment SearchResultsContentFragment on SEARCH_Result {\n  currentUrl\n  canonicalUrl\n  adTargetings @skip(if: `$isBot)\n  ...SearchResultHeaderLocationFragment\n  ...SearchResultsMarketDetailsFragment @include(if: `$isBot)\n  ...SearchResultsHomesListFragment\n  ...SearchResultsPaginationFragment\n  ...SearchResultsBreadcrumbsFragment\n  ...SearchResultsMapFragment\n  ...SearchResultsFooterCardFragment\n  ...SearchResultsFiltersFragment\n  ...SearchResultsProviderAttributionFragment\n  details {\n    ...SearchDetailsFragment\n    canonicalUrl\n    __typename\n  }\n  names {\n    title\n    locationName\n    description\n    __typename\n  }\n  tracking {\n    key\n    value\n    __typename\n  }\n  pageDisplayFlags {\n    isAdvertisingRestricted\n    __typename\n  }\n  nearByHomes {\n    ...HomeDetailsCardFragment\n    ...HomeDetailsCardPhotosFragment\n    ...SingleFamilyResidenceJsonLdFragment\n    ...OpenHouseJsonLdFragment\n    ...HomeDetailsCallToActionFragment\n    ...HomeDetailsTopThirdFragment @include(if: `$isSPA)\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultHeaderLocationFragment on SEARCH_Result {\n  location {\n    ... on SEARCH_ResultLocationBoundingBox {\n      city\n      state\n      __typename\n    }\n    ... on SEARCH_ResultLocationCity {\n      city\n      state\n      __typename\n    }\n    ... on SEARCH_ResultLocationCounty {\n      county\n      state\n      __typename\n    }\n    ... on SEARCH_ResultLocationNeighborhood {\n      city\n      state\n      neighborhood\n      __typename\n    }\n    ... on SEARCH_ResultLocationPostalCode {\n      city\n      state\n      postalCode\n      __typename\n    }\n    ... on SEARCH_ResultLocationSchool {\n      name\n      __typename\n    }\n    ... on SEARCH_ResultLocationSchoolDistrict {\n      city\n      state\n      schoolDistrictIds\n      __typename\n    }\n    __typename\n  }\n  recentSearches {\n    title\n    type\n    url\n    locationDetails {\n      cities {\n        city\n        state\n        __typename\n      }\n      counties\n      neighborhoods\n      zips\n      schoolDistricts\n      school {\n        id\n        name\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  pageDisplayFlags {\n    shouldDisplayZINCAttribution\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsHomesListFragment on SEARCH_Result {\n  homeCounts {\n    agentListingsCount {\n      value\n      __typename\n    }\n    otherListingsCount {\n      value\n      __typename\n    }\n    __typename\n  }\n  homes {\n    ...HomeDetailsCardFragment\n    ...HomeDetailsCardPhotosFragment\n    ...SingleFamilyResidenceJsonLdFragment\n    ...OpenHouseJsonLdFragment\n    ...HomeDetailsCallToActionFragment\n    ...HomeDetailsTopThirdFragment @include(if: `$isSPA)\n    __typename\n  }\n  ...FailedSearchFragment\n  names {\n    headerTag\n    subHeaderTag\n    resultsIncludeDescription\n    searchResultsMapTag\n    nearByHeaderTag\n    nearBySubHeaderTag\n    __typename\n  }\n  totalHomes\n  details {\n    ...SearchResultsSortFragment\n    __typename\n  }\n  emptyState {\n    noHomesFoundText\n    noHomesFoundCTAText\n    reason\n    __typename\n  }\n  moreHomesInformation {\n    title\n    body\n    ctaTitle\n    __typename\n  }\n  __typename\n}\n\nfragment HomeDetailsCardFragment on HOME_Details {\n  __typename\n  location {\n    city\n    stateCode\n    neighborhoodName\n    fullLocation: formattedLocation(formatType: STREET_CITY_STATE_ZIP)\n    partialLocation: formattedLocation(formatType: STREET_ONLY)\n    __typename\n  }\n  price {\n    formattedPrice\n    __typename\n  }\n  url\n  tags(include: MINIMAL) {\n    level\n    formattedName\n    icon {\n      vectorImage {\n        svg\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  fullTags: tags {\n    level\n    formattedName\n    icon {\n      vectorImage {\n        svg\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  floorSpace {\n    formattedDimension\n    __typename\n  }\n  bedrooms {\n    formattedValue(formatType: TWO_LETTER_ABBREVIATION)\n    __typename\n  }\n  bathrooms {\n    formattedValue(formatType: TWO_LETTER_ABBREVIATION)\n    __typename\n  }\n  isSaveable\n  preferences {\n    isSaved\n    __typename\n  }\n  metadata {\n    compositeId\n    legacyIdForSave\n    __typename\n  }\n  tracking {\n    key\n    value\n    __typename\n  }\n  displayFlags {\n    showMLSLogoOnListingCard\n    addAttributionProminenceOnListCard\n    __typename\n  }\n  ... on HOME_RoomForRent {\n    numberOfRoommates\n    availableDate: formattedAvailableDate(dateFormat: \`"MMM D\`")\n    __typename\n  }\n  ... on HOME_RentalCommunity {\n    activeListing {\n      provider {\n        summary(formatType: SHORT)\n        listingSource {\n          logoUrl\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  ... on HOME_Property {\n    currentStatus {\n      isRecentlySold\n      isRecentlyRented\n      isActiveForRent\n      isActiveForSale\n      isOffMarket\n      isForeclosure\n      __typename\n    }\n    priceChange {\n      priceChangeDirection\n      __typename\n    }\n    activeListing {\n      provider {\n        summary(formatType: SHORT)\n        extraShortSummary: summary(formatType: EXTRA_SHORT)\n        listingSource {\n          logoUrl\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    lastSold {\n      provider {\n        summary(formatType: SHORT)\n        extraShortSummary: summary(formatType: EXTRA_SHORT)\n        listingSource {\n          logoUrl\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  ... on HOME_FloorPlan {\n    priceChange {\n      priceChangeDirection\n      __typename\n    }\n    provider {\n      summary(formatType: SHORT)\n      __typename\n    }\n    __typename\n  }\n  ... on HOME_RentalCommunity {\n    location {\n      communityLocation: formattedLocation(formatType: STREET_COMMUNITY_NAME)\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment HomeDetailsCardPhotosFragment on HOME_Details {\n  media {\n    __typename\n    heroImage(fallbacks: `$heroImageFallbacks) {\n      url {\n        small\n        __typename\n      }\n      webpUrl: url(compression: webp) {\n        small\n        __typename\n      }\n      __typename\n    }\n    photos {\n      url {\n        small\n        __typename\n      }\n      webpUrl: url(compression: webp) {\n        small\n        __typename\n      }\n      __typename\n    }\n  }\n  __typename\n}\n\nfragment HomeDetailsCallToActionFragment on HOME_Details {\n  hasPrequalifiers\n  leadFormCallToAction(context: CARD, appendOneClick: true) {\n    callToActionType\n    callToActionDisplayLabel\n    supportsCancellableSubmission\n    buttonStyle\n    __typename\n  }\n  __typename\n}\n\nfragment FailedSearchFragment on SEARCH_Result {\n  names {\n    locationName\n    __typename\n  }\n  location {\n    __typename\n    ... on SEARCH_ResultLocationPointOfInterest {\n      exactCoordinates {\n        latitude\n        longitude\n        __typename\n      }\n      __typename\n    }\n  }\n  __typename\n}\n\nfragment SearchResultsSortFragment on SEARCHDETAILS_Details {\n  filters {\n    sort {\n      type\n      ascending\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SingleFamilyResidenceJsonLdFragment on HOME_Property {\n  location {\n    partialLocation: formattedLocation(formatType: STREET_ONLY)\n    city\n    stateCode\n    zipCode\n    coordinates {\n      latitude\n      longitude\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment OpenHouseDateFragment on HOME_Listing {\n  openHouses {\n    ... on HOME_ScheduledOpenHouse {\n      start\n      end\n      startHour: formattedStartTime(format: \`"hA\`")\n      endHour: formattedEndTime(format: \`"hA\`")\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment OpenHouseJsonLdFragment on HOME_Details {\n  ... on HOME_Property {\n    url\n    location {\n      formattedLocation\n      partialLocation: formattedLocation(formatType: STREET_ONLY)\n      city\n      stateCode\n      zipCode\n      coordinates {\n        latitude\n        longitude\n        __typename\n      }\n      __typename\n    }\n    activeForSaleListing {\n      ...OpenHouseDateFragment\n      __typename\n    }\n    activeForRentListing {\n      ...OpenHouseDateFragment\n      __typename\n    }\n    media {\n      hasThreeDHome\n      hasVideo\n      __typename\n    }\n    ...VirtualTourJsonLdSchemaFragment\n    __typename\n  }\n  ... on HOME_RoomForRent {\n    activeForRentListing {\n      ...OpenHouseDateFragment\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment VirtualTourJsonLdSchemaFragment on HOME_Details {\n  price {\n    ... on HOME_SinglePrice {\n      price\n      __typename\n    }\n    ... on HOME_ValuationPrice {\n      price\n      __typename\n    }\n    ... on HOME_ListingSinglePrice {\n      price\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment HomeDetailsTopThirdFragment on HOME_Details {\n  bathrooms {\n    summaryBathrooms: formattedValue(formatType: COMMON_ABBREVIATION)\n    __typename\n  }\n  bedrooms {\n    summaryBedrooms: formattedValue(formatType: COMMON_ABBREVIATION)\n    __typename\n  }\n  floorSpace {\n    formattedDimension\n    __typename\n  }\n  location {\n    city\n    coordinates {\n      latitude\n      longitude\n      __typename\n    }\n    neighborhoodName\n    stateCode\n    zipCode\n    cityStateZipAddress: formattedLocation(formatType: CITY_STATE_ZIP)\n    homeFormattedAddress: formattedLocation\n    summaryFormattedLocation: formattedLocation(formatType: STREET_COMMUNITY_BUILDER)\n    __typename\n  }\n  media {\n    metaTagHeroImages: heroImage(fallbacks: `$heroImageFallbacks) {\n      url {\n        desktop: custom(size: {width: 2048, height: 200})\n        __typename\n      }\n      __typename\n    }\n    topThirdHeroImages: heroImage(fallbacks: `$heroImageFallbacks) {\n      __typename\n      url {\n        extraSmallSrc: custom(size: {width: 375, height: 275})\n        smallSrc: custom(size: {width: 570, height: 275})\n        mediumSrc: custom(size: {width: 768, height: 500})\n        largeSrc: custom(size: {width: 992, height: 500})\n        hiDipExtraSmallSrc: custom(size: {width: 1125, height: 825})\n        hiDpiSmallSrc: custom(size: {width: 1710, height: 825})\n        hiDpiMediumSrc: custom(size: {width: 2048, height: 1536})\n        __typename\n      }\n      webpUrl: url(compression: webp) {\n        extraSmallWebpSrc: custom(size: {width: 375, height: 275})\n        smallWebpSrc: custom(size: {width: 570, height: 275})\n        mediumWebpSrc: custom(size: {width: 768, height: 500})\n        largeWebpSrc: custom(size: {width: 992, height: 500})\n        hiDipExtraSmallWebpSrc: custom(size: {width: 1125, height: 825})\n        hiDpiSmallWebpSrc: custom(size: {width: 1710, height: 825})\n        hiDpiMediumWebpSrc: custom(size: {width: 2048, height: 1536})\n        __typename\n      }\n    }\n    totalPhotoCount\n    __typename\n  }\n  metadata {\n    compositeId\n    currentListingId\n    __typename\n  }\n  pageText {\n    title\n    metaDescription\n    __typename\n  }\n  price {\n    formattedPrice\n    ... on HOME_LastSoldPrice {\n      formattedPriceDifferencePercent\n      formattedSoldDate(dateFormat: \`"MMM D, YYYY\`")\n      listingPrice {\n        formattedPrice(formatType: SHORT_ABBREVIATION)\n        __typename\n      }\n      priceDifferencePercent\n      pricePerDimension {\n        formattedDimension\n        __typename\n      }\n      __typename\n    }\n    ... on HOME_ForeclosureEstimatePrice {\n      price\n      typeDescription\n      __typename\n    }\n    ... on HOME_PriceRange {\n      currencyCode\n      max\n      min\n      __typename\n    }\n    ... on HOME_SinglePrice {\n      currencyCode\n      price\n      __typename\n    }\n    __typename\n  }\n  tracking {\n    key\n    value\n    __typename\n  }\n  url\n  ... on HOME_Property {\n    currentStatus {\n      isOffMarket\n      isRecentlySold\n      isForeclosure\n      isActiveForRent\n      isActiveForSale\n      isRecentlyRented\n      label\n      __typename\n    }\n    __typename\n  }\n  ... on HOME_RentalCommunity {\n    location {\n      rentalCommunityFormattedLocation: formattedLocation(formatType: STREET_COMMUNITY_NAME)\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsPaginationFragment on SEARCH_Result {\n  totalHomes\n  currentUrl\n  details {\n    filters {\n      page\n      limit\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsBreadcrumbsFragment on SEARCH_Result {\n  navigation {\n    label\n    url\n    linkType\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsMapFragment on SEARCH_Result {\n  mapEmptyState: emptyState(format: SHORT) {\n    noHomesFoundText\n    __typename\n  }\n  details {\n    filters {\n      zoom\n      __typename\n    }\n    __typename\n  }\n  names {\n    searchResultsMapTag\n    __typename\n  }\n  location {\n    boundingBox {\n      minCoordinates {\n        latitude\n        longitude\n        __typename\n      }\n      maxCoordinates {\n        latitude\n        longitude\n        __typename\n      }\n      __typename\n    }\n    ... on SEARCH_ResultLocationCity {\n      locationId\n      __typename\n    }\n    ... on SEARCH_ResultLocationCounty {\n      locationId\n      __typename\n    }\n    ... on SEARCH_ResultLocationNeighborhood {\n      locationId\n      __typename\n    }\n    ... on SEARCH_ResultLocationPostalCode {\n      locationId\n      __typename\n    }\n    __typename\n  }\n  ...HomeMarkerLayersContainerFragment\n  ...HoverCardLayerFragment\n  __typename\n}\n\nfragment HomeMarkerLayersContainerFragment on SEARCH_Result {\n  ...HomeMarkersLayerFragment\n  __typename\n}\n\nfragment HomeMarkersLayerFragment on SEARCH_Result {\n  homes {\n    location {\n      coordinates {\n        latitude\n        longitude\n        __typename\n      }\n      __typename\n    }\n    url\n    metadata {\n      compositeId\n      __typename\n    }\n    ...HomeMarkerFragment\n    __typename\n  }\n  nearByHomes {\n    ...HomeMarkerFragment\n    __typename\n  }\n  __typename\n}\n\nfragment HomeMarkerFragment on HOME_Details {\n  media {\n    hasThreeDHome\n    __typename\n  }\n  location {\n    coordinates {\n      latitude\n      longitude\n      __typename\n    }\n    __typename\n  }\n  displayFlags {\n    enableMapPin\n    __typename\n  }\n  price {\n    calloutMarkerPrice: formattedPrice(formatType: SHORT_ABBREVIATION)\n    __typename\n  }\n  url\n  ... on HOME_Property {\n    activeForSaleListing {\n      openHouses {\n        formattedDay\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  ...HomeDetailsTopThirdFragment @include(if: `$isSPA)\n  __typename\n}\n\nfragment HoverCardLayerFragment on SEARCH_Result {\n  homes {\n    ...HomeHoverCardFragment\n    __typename\n  }\n  nearByHomes {\n    ...HomeHoverCardFragment\n    __typename\n  }\n  __typename\n}\n\nfragment HomeHoverCardFragment on HOME_Details {\n  ...HomeDetailsCardFragment\n  ...HomeDetailsCardHeroFragment\n  location {\n    coordinates {\n      latitude\n      longitude\n      __typename\n    }\n    __typename\n  }\n  displayFlags {\n    enableMapPin\n    showMLSLogoOnMapMarkerCard\n    __typename\n  }\n  __typename\n}\n\nfragment HomeDetailsCardHeroFragment on HOME_Details {\n  media {\n    heroImage(fallbacks: `$heroImageFallbacks) {\n      url {\n        small\n        __typename\n      }\n      webpUrl: url(compression: webp) {\n        small\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsFiltersFragment on SEARCH_Result {\n  transitSystems {\n    name\n    iconUrl(format: SVG)\n    isSelected\n    filterLabel\n    __typename\n  }\n  homeCounts {\n    agentListingsCount {\n      formattedValue\n      __typename\n    }\n    otherListingsCount {\n      formattedValue\n      __typename\n    }\n    __typename\n  }\n  details {\n    searchType\n    ...SearchResultsSortFragment\n    filters {\n      isAlternateListingSource\n      price {\n        min\n        max\n        __typename\n      }\n      bedrooms {\n        min\n        max\n        __typename\n      }\n      bathrooms {\n        min\n        max\n        __typename\n      }\n      squareFeet {\n        min\n        max\n        __typename\n      }\n      hoaFee {\n        min\n        max\n        __typename\n      }\n      propertyTypes\n      lotSize {\n        min\n        max\n        __typename\n      }\n      mlsId\n      newListing {\n        range {\n          min\n          max\n          timestamp\n          __typename\n        }\n        daysAgo\n        __typename\n      }\n      recentlyReduced {\n        range {\n          min\n          max\n          timestamp\n          __typename\n        }\n        daysAgo\n        __typename\n      }\n      openHomes {\n        range {\n          min\n          max\n          timestamp\n          __typename\n        }\n        type\n        __typename\n      }\n      yearBuilt {\n        min\n        max\n        __typename\n      }\n      keywords\n      listingTypes\n      soldWithin\n      pets\n      furnished\n      rentalListingTags\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsProviderAttributionFragment on SEARCH_Result {\n  providers {\n    listingSource {\n      logoUrl\n      attribution\n      alternativeSources {\n        name\n        url\n        __typename\n      }\n      disclaimer {\n        markdown\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsMarketDetailsFragment on SEARCH_Result {\n  ...SearchResultsNeighborhoodsListFragment\n  ...MarketInsightsDataFragment\n  ...SearchResultsSummaryFragment\n  ...SearchResultsWhatLocalsSayFragment\n  __typename\n}\n\nfragment SearchResultsNeighborhoodsListFragment on SEARCH_Result {\n  surroundings {\n    ...NeighborhoodCardFragment\n    __typename\n  }\n  __typename\n}\n\nfragment NeighborhoodCardFragment on SURROUNDINGS_Neighborhood {\n  name\n  ndpActive\n  ndpUrl\n  media {\n    heroImage {\n      ... on MEDIA_HeroImageMap {\n        url {\n          path: custom(size: {width: 136, height: 136, cropMode: fill}, zoomLevel: 1100)\n          __typename\n        }\n        __typename\n      }\n      ... on MEDIA_HeroImageStory {\n        url {\n          path: custom(size: {width: 136, height: 136, cropMode: fill})\n          __typename\n        }\n        __typename\n      }\n      ... on MEDIA_HeroImagePhoto {\n        url {\n          path: custom(size: {width: 136, height: 136, cropMode: fill})\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  localFacts {\n    forSaleStats {\n      min\n      max\n      __typename\n    }\n    homesForSaleCount\n    forRentStats {\n      min\n      max\n      __typename\n    }\n    homesForRentCount\n    soldHomesStats {\n      min\n      max\n      __typename\n    }\n    soldHomesCount\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsWhatLocalsSayFragment on SEARCH_Result {\n  searchLocationSurroundings {\n    locationId\n    name\n    ... on SURROUNDINGS_Neighborhood {\n      ndpType\n      ndpUrl\n      name\n      ndpActive\n      localUGC {\n        ... on SURROUNDINGS_LocalUGC {\n          ...LocalUGCFragment\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    ... on SURROUNDINGS_City {\n      localUGC {\n        ... on SURROUNDINGS_LocalUGC {\n          ...LocalUGCFragment\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment LocalUGCFragment on SURROUNDINGS_LocalUGC {\n  title\n  stats {\n    attributes {\n      type\n      name\n      score\n      __typename\n    }\n    minimumResponseCount\n    __typename\n  }\n  localReviews {\n    categories {\n      id\n      displayName\n      reviewCount\n      callToAction\n      __typename\n    }\n    totalReviews\n    reviews(limitPerCategory: 8) {\n      id\n      text\n      context {\n        displayName\n        __typename\n      }\n      category {\n        id\n        displayName\n        __typename\n      }\n      dateCreated\n      reactionSummary {\n        counts {\n          helpful\n          __typename\n        }\n        viewerReactions {\n          helpful\n          __typename\n        }\n        __typename\n      }\n      flagSummary {\n        totalCount\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsSummaryFragment on SEARCH_Result {\n  marketInsights(sourceAllFromZHVI: `$isMoreStatsTrendsEnabled) {\n    rentalMarketInsights {\n      medianRentalPriceAverageForPastYear\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment MarketInsightsDataFragment on SEARCH_Result {\n  names {\n    locationName\n    __typename\n  }\n  ...PartialMarketInsightsDataFragment\n  surroundings {\n    ...NeighborhoodDataFragment\n    __typename\n  }\n  __typename\n}\n\nfragment PartialMarketInsightsDataFragment on SEARCH_Result {\n  marketInsights(sourceAllFromZHVI: `$isMoreStatsTrendsEnabled) {\n    homeStatsByBedroomCount: statsByHomeFeature(featureType: BEDROOMS) @include(if: `$isMoreStatsTrendsEnabled) {\n      displayName\n      featureStats {\n        displayName\n        homeValueIndexPrice\n        inventorySummary\n        ... on STATS_AND_TRENDS_HomeFeatureStat {\n          forSaleSearchUrl\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    affordability {\n      name\n      summary\n      trend {\n        value\n        formattedValue\n        date\n        formattedDate(dateFormat: \`"MMMM YYYY\`")\n        __typename\n      }\n      __typename\n    }\n    affordabilityAttribution\n    __typename\n  }\n  __typename\n}\n\nfragment NeighborhoodDataFragment on SURROUNDINGS_Neighborhood {\n  name\n  forSaleNeighborhoodSearchCanonicalURL\n  localFacts {\n    homesForSaleCount\n    __typename\n  }\n  __typename\n}\n\nfragment SearchResultsFooterCardFragment on SEARCH_Result {\n  homes {\n    ...HomeDetailsCardFragment\n    ...HomeDetailsCardPhotosFragment\n    ...HomeDetailsTopThirdFragment @include(if: `$isSPA)\n    __typename\n  }\n  __typename\n}\n\nfragment SearchDetailsFragment on SEARCHDETAILS_Details {\n  searchType\n  location {\n    cities {\n      city\n      state\n      __typename\n    }\n    counties\n    neighborhoods\n    zips\n    schoolDistricts\n    university {\n      id\n      name\n      __typename\n    }\n    school {\n      id\n      name\n      __typename\n    }\n    customArea {\n      latLngs {\n        latitude\n        longitude\n        __typename\n      }\n      encodedPolygon\n      __typename\n    }\n    commute {\n      type\n      maxTime\n      polygons {\n        latitude\n        longitude\n        __typename\n      }\n      __typename\n    }\n    pointOfInterest {\n      latitude\n      longitude\n      __typename\n    }\n    coordinates {\n      center {\n        latitude\n        longitude\n        __typename\n      }\n      southEast {\n        latitude\n        longitude\n        __typename\n      }\n      northEast {\n        latitude\n        longitude\n        __typename\n      }\n      southWest {\n        latitude\n        longitude\n        __typename\n      }\n      northWest {\n        latitude\n        longitude\n        __typename\n      }\n      __typename\n    }\n    radiusSize\n    __typename\n  }\n  filters {\n    bedrooms {\n      min\n      max\n      __typename\n    }\n    bathrooms {\n      min\n      max\n      __typename\n    }\n    price {\n      min\n      max\n      __typename\n    }\n    squareFeet {\n      min\n      max\n      __typename\n    }\n    hoaFee {\n      min\n      max\n      __typename\n    }\n    zoom\n    street\n    propertyTypes\n    lotSize {\n      min\n      max\n      __typename\n    }\n    mlsId\n    newListing {\n      range {\n        min\n        max\n        timestamp\n        __typename\n      }\n      daysAgo\n      __typename\n    }\n    openHomes {\n      range {\n        min\n        max\n        timestamp\n        __typename\n      }\n      __typename\n    }\n    percentChanged\n    recentlyReduced {\n      range {\n        min\n        max\n        timestamp\n        __typename\n      }\n      daysAgo\n      __typename\n    }\n    pricePerSquareFoot {\n      min\n      max\n      __typename\n    }\n    yearBuilt {\n      min\n      max\n      __typename\n    }\n    keywords\n    listingTypes\n    foreclosureTypes\n    discoveryGroup\n    sort {\n      type\n      ascending\n      __typename\n    }\n    soldWithin\n    pets\n    brokerFee\n    buildingAmenities\n    unitAmenities\n    furnished\n    rentalListingTags\n    landlordPays\n    page\n    offset\n    limit\n    transit {\n      system\n      line\n      station\n      __typename\n    }\n    __typename\n  }\n  canonicalUrl\n  description\n  __typename\n}\n\nfragment HeaderAndFooterFragment on SEARCH_Result {\n  primaryNavigation {\n    ...Header\n    __typename\n  }\n  secondaryNavigation {\n    ...Footer\n    __typename\n  }\n  __typename\n}\n\nfragment Header on PRIMARY_NAVIGATION_NavigationItem {\n  label\n  uri\n  description\n  children {\n    label\n    uri\n    description\n    children {\n      label\n      uri\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment Footer on SECONDARY_NAVIGATION_SecondaryNavigation {\n  main {\n    label\n    uri\n    children {\n      label\n      uri\n      __typename\n    }\n    __typename\n  }\n  internal {\n    label\n    uri\n    children {\n      label\n      uri\n      isNoFollow\n      __typename\n    }\n    __typename\n  }\n  brand {\n    label\n    uri\n    children {\n      label\n      uri\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment Viewer on USER_Viewer {\n  userStatus\n  userType\n  userId\n  loggedIn\n  name\n  email\n  profileImage {\n    small\n    __typename\n  }\n  userNavigation {\n    label\n    uri\n    description\n    children {\n      label\n      uri\n      __typename\n    }\n    __typename\n  }\n  optedOutOfSale\n  __typename\n}\n\nfragment SearchResultsBranchBannerFragmnet on SEARCH_Result {\n  location {\n    ... on SEARCH_ResultLocationBoundingBox {\n      city\n      state\n      __typename\n    }\n    ... on SEARCH_ResultLocationCity {\n      city\n      state\n      __typename\n    }\n    ... on SEARCH_ResultLocationNeighborhood {\n      city\n      state\n      neighborhood\n      __typename\n    }\n    ... on SEARCH_ResultLocationCounty {\n      county\n      state\n      __typename\n    }\n    ... on SEARCH_ResultLocationNeighborhood {\n      city\n      state\n      neighborhood\n      __typename\n    }\n    ... on SEARCH_ResultLocationPostalCode {\n      city\n      state\n      postalCode\n      __typename\n    }\n    ... on SEARCH_ResultLocationSchool {\n      city\n      state\n      schoolName: name\n      __typename\n    }\n    ... on SEARCH_ResultLocationCustomArea {\n      city\n      state\n      __typename\n    }\n    ... on SEARCH_ResultLocationPointOfInterest {\n      city\n      state\n      __typename\n    }\n    ... on SEARCH_ResultLocationSchoolDistrict {\n      city\n      state\n      schoolDistrictName: name\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n`"}"
        $r = [Execute.httpRequest]::Send(
            $uri,
            [System.Net.Http.HttpMethod]::Post,
            $Headers,
            $null,
            $ContentType,
            $Body
        )
        $json = $r.ResponseText | ConvertFrom-Json
        $JSON.data.searchHomesByDetails.homes.ForEach({ $results += $_ })
    }
    return $results
}